{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4 mt-4 max-w-2xl">
    
    <div class="mb-6 pb-2 border-b border-gray-200">
        <h2 class="text-3xl font-black text-gray-800 tracking-tight">
            <i class="fas fa-bell text-yellow-500 mr-2"></i> Suas Notificações
        </h2>
        <p class="text-gray-500 text-sm mt-1">Veja as últimas interações no seu AquaNet.</p>
    </div>

    <div class="bg-white rounded-3xl shadow-xl border border-gray-100 overflow-hidden divide-y divide-gray-100">
        
        {% for n in notifications %}
            {% set target_url = url_for('profile', username=n.sender.username) if n.action == 'follow' else (url_for('post_detail', post_id=n.post_id) if n.post_id else '#') %}
            
            <div class="flex items-start p-4 hover:bg-gray-50 transition-all relative group">
                
                <div class="flex-shrink-0 mr-4 mt-1">
                     <div class="w-10 h-10 rounded-full flex items-center justify-center
                                {% if n.action == 'like_post' or n.action == 'like_comment' %} bg-red-100 text-red-500 
                                {% elif n.action == 'comment' or n.action == 'reply' %} bg-blue-100 text-blue-500 
                                {% elif n.action == 'follow' %} bg-green-100 text-green-500 
                                {% else %} bg-gray-100 text-gray-400 {% endif %}">
                        {% if n.action == 'like_post' or n.action == 'like_comment' %} <i class="fas fa-heart"></i>
                        {% elif n.action == 'comment' or n.action == 'reply' %} <i class="fas fa-comment"></i>
                        {% elif n.action == 'follow' %} <i class="fas fa-user-plus"></i>
                        {% else %} <i class="fas fa-info"></i>
                        {% endif %}
                    </div>
                </div>

                <div class="flex-grow min-w-0"> <div class="flex justify-between items-start">
                        
                        <a href="{{ url_for('profile', username=n.sender.username) }}" class="flex items-center group/profile pr-2 max-w-[70%]">
                            <img src="{{ n.sender.profile_pic_url }}" class="w-5 h-5 rounded-full object-cover mr-2 border border-gray-200 flex-shrink-0">
                            <span class="font-bold text-gray-900 hover:underline hover:text-blue-600 text-sm truncate">
                                @{{ n.sender.username }}
                            </span>
                        </a>

                        <small class="text-[10px] text-gray-400 whitespace-nowrap flex-shrink-0 mt-0.5">
                            {{ n.timestamp.strftime('%d/%m %H:%M') }}
                        </small>
                    </div>

                    <a href="{{ target_url }}" class="block text-sm text-gray-600 hover:text-gray-900 transition-colors mt-0.5">
                        {% if n.action == 'like_post' %} 
                            curtiu seu post. <i class="fas fa-heart text-red-400 text-xs ml-1"></i>
                        {% elif n.action == 'like_comment' %} 
                            curtiu seu comentário.
                        {% elif n.action == 'comment' %} 
                            comentou: <span class="italic text-gray-500">"Ver comentário..."</span>
                        {% elif n.action == 'follow' %} 
                            começou a te seguir.
                        {% elif n.action == 'reply' %} 
                            respondeu seu comentário.
                        {% endif %}
                    </a>
                </div>

            </div>
        {% else %}
            <div class="p-12 text-center text-gray-500">
                <div class="w-16 h-16 bg-blue-50 text-blue-300 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-bell-slash text-2xl"></i>
                </div>
                <h4 class="font-bold text-gray-700">Tudo calmo por aqui</h4>
                <p class="text-sm mt-2">Você ainda não recebeu notificações.</p>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}